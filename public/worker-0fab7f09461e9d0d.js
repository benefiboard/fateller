!function(){async function e(){try{console.log("오프라인 메모 동기화 중...")}catch(e){console.error("동기화 실패:",e)}}async function t(){try{console.log("메모 검색 인덱스 업데이트 중...")}catch(e){console.error("인덱스 업데이트 실패:",e)}}self.addEventListener("sync",t=>{"sync-memos"===t.tag&&t.waitUntil(e())}),self.addEventListener("push",e=>{var t,n;let i=null!==(n=null===(t=e.data)||void 0===t?void 0:t.json())&&void 0!==n?n:{},o=i.title||"BrainLabel 알림",s={body:i.body||"새로운 인사이트가 발견되었습니다.",icon:"/icons/icon-192x192.png",badge:"/icons/icon-192x192.png",data:{url:i.url||"/"}};e.waitUntil(self.registration.showNotification(o,s))}),self.addEventListener("notificationclick",e=>{var t;e.notification.close();let n=(null===(t=e.notification.data)||void 0===t?void 0:t.url)||"/";e.waitUntil(self.clients.matchAll({type:"window"}).then(e=>{for(let t of e)if(t.url===n&&"focus"in t)return t.focus();return self.clients.openWindow?self.clients.openWindow(n):Promise.resolve()}))}),self.addEventListener("message",e=>{"ONLINE_AGAIN"===e.data&&self.registration.sync.register("sync-memos").catch(e=>{console.error("동기화 등록 실패:",e)})}),self.addEventListener("fetch",e=>{e.request.url.match(/\.(jpe?g|png|gif|svg)$/)&&e.respondWith(caches.open("brainlabel-images").then(async t=>{let n=await t.match(e.request);if(n)return e.waitUntil(fetch(e.request).then(n=>(t.put(e.request,n.clone()),n))),n;let i=await fetch(e.request);return t.put(e.request,i.clone()),i}).catch(()=>caches.match("/icons/placeholder-image.jpg")))}),self.addEventListener("periodicsync",e=>{"refresh-memos-index"===e.tag&&e.waitUntil(t())})}();